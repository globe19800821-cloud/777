<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>åŠè‡ªå‹•éŠæˆ² AI ç›£æ§ + å¤§çè­¦å ±</title>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.6.0/dist/tf.min.js"></script>
<style>
body { font-family: Arial; margin: 20px; }
#canvasPreview { border: 1px solid #ccc; }
#status { font-weight: bold; margin-top: 10px; }
.bigwin { color: red; font-size: 1.5em; font-weight: bold; }
</style>
</head>
<body>
<h2>éŠæˆ²ç›£æ§ AIï¼ˆåŠè‡ªå‹•ï¼‰</h2>

<p>è«‹è‡ªè¡Œæ‰“é–‹éŠæˆ²é é¢ä¸¦æˆªåœ–æˆ–æ‹–åœ–åˆ°ä¸‹æ–¹ Canvas</p>
<input type="file" id="uploadImg" accept="image/*"><br>
<canvas id="canvasPreview" width="300" height="300"></canvas>
<div id="status">ç‹€æ…‹ï¼šå°šæœªé–‹å§‹</div>

<button id="startMonitor">é–‹å§‹ç›£æ§</button>

<script>
let selectedArea = {x:0, y:0, w:300, h:300};
let monitoring = false;
let img = new Image();
const canvas = document.getElementById("canvasPreview");
const ctx = canvas.getContext("2d");

document.getElementById("uploadImg").addEventListener("change", (e)=>{
  const file = e.target.files[0];
  if(!file) return;
  img.src = URL.createObjectURL(file);
  img.onload = ()=> ctx.drawImage(img,0,0,canvas.width,canvas.height);
});

document.getElementById("startMonitor").addEventListener("click", ()=>{
  if(!img.src) return alert("è«‹å…ˆä¸Šå‚³æˆªåœ–");
  monitoring = true;
  document.getElementById("status").innerText = "ç‹€æ…‹ï¼šç›£æ§ä¸­...";
  monitorLoop();
});

// æ¨¡æ“¬ç‰¹å¾µå‘é‡
function extractFeatures() {
  // çœŸå¯¦å¯ä»¥ç”¨ Canvas pixel åˆ†æ
  return [
    Math.random(), // ç©ºè½‰æ¯”ä¾‹
    Math.random(), // å¹³å‡å‹•ç•«æ™‚é–“
    Math.random(), // ç‰¹æ®Šç¬¦è™Ÿ
    Math.random(), // äº®åº¦
    Math.random()  // ç¯€å¥
  ];
}

// AI åˆ¤æ–·åå¸/åå
function predictState(features){
  const score = features[0]*0.4 + (1-features[1])*0.3 + (1-features[2])*0.2 + (1-features[3])*0.1;
  if(score>0.7) return "åå¸åˆ†";
  else if(score>0.4) return "ä¸­æ€§";
  else return "åååˆ†";
}

// å¤§çè­¦å ±
function checkBigWin(features){
  const score = 0.5*features[1] + 0.4*features[2] + 0.1*features[3];
  if(score>0.7){
    document.getElementById("status").innerHTML = '<span class="bigwin">ğŸ”¥ å¤§çè­¦å ±ï¼ ğŸ”¥</span>';
    return true;
  }
  return false;
}

// ä¸»å¾ªç’°
function monitorLoop(){
  if(!monitoring) return;
  const features = extractFeatures();
  checkBigWin(features);
  const state = predictState(features);
  document.getElementById("status").innerText += ` åå‘ç‹€æ…‹ï¼š${state}`;
  setTimeout(monitorLoop,1000); // æ¯ç§’æ›´æ–°ä¸€æ¬¡
}
</script>
</body>
</html>
